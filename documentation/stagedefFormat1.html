<!--This is auto-generated. Do not edit.--><h1 id="spec-stagedefFormat1">SMB 1 StageDef Format (Formerly .lz.raw)</h1><h2>Notes</h2><ul><li>All offsets written to file are relative to the beginning of the file</li><li>Try to keep things 4 byte aligned if possible other than the collision grid triangle list (based on the specs, it seems to be built like this)</li><li>Objects names need to be put somewhere in the file</li><li>Put an extra 4 zero bytes after the level models?</li><li>Normal levels only have one start position, minigames can have more</li><li>Reflective objects must not have textures, and must be planar</li><li>The order you write objects into the file can matter</li><li>Recommended order (it works, other orders may work as well)</li><li>File Header, Start positions, Fallout Y, Other config items, Collision field headers, collision triangles, Collision grid triangle list, Collision grid pointers, Level models, Reflective models, Background models, Object name offset, Object name ASCII</li><li>The Collision Grid is used for optimization</li><ul><li>Collisions are divided into a matrix based on triangle position</li><li>The matrix elements start at (startX + (stepX * i), startZ + (stepZ * j)) position</li><li>Each collision grid pointer is used for a different element in the matrix</li><li>By dividing the triangles into spatial sections, it allows the game to not test every triangle every frame</li><li>Have 256 collision grid pointers that point to different triangle lists</li><li>If not optimizing, triangle lists can just count through the number of triangles</li></ul><li>The center of rotation in the collision header may not work as one may expect. Setting the center of rotation will translate the object(s) by the negative of what was set (Effectively making the object appear to jump to 0, 0, 0 usually). Position keyframes are then used to move the object back to its desired location.</li></ul><h2>Sections</h2><ul><li><a href="#spec-stagedefFormat1-section-fileHeader">File Header</a></li><li><a href="#spec-stagedefFormat1-section-startPosition">Start Position</a></li><li><a href="#spec-stagedefFormat1-section-goal">Goal</a></li><li><a href="#spec-stagedefFormat1-section-bumper">Bumper</a></li><li><a href="#spec-stagedefFormat1-section-jamabar">Jamabar</a></li><li><a href="#spec-stagedefFormat1-section-banana">Banana</a></li><li><a href="#spec-stagedefFormat1-section-collisionHeader">Collision Header</a></li><li><a href="#spec-stagedefFormat1-section-levelModel">Level Model</a></li><li><a href="#spec-stagedefFormat1-section-backgroundModel">Background Model</a></li><li><a href="#spec-stagedefFormat1-section-reflective">Reflective Model</a></li><li><a href="#spec-stagedefFormat1-section-collisionTriangle">Collision Triangle</a></li><li><a href="#spec-stagedefFormat1-section-collisionGridTriangleList">Collision Grid Triangle List</a></li><li><a href="#spec-stagedefFormat1-section-collisionGridTriangleListPointer">Collision Grid Triangle List Pointer</a></li><li><a href="#spec-stagedefFormat1-section-animationHeader">Animation Header</a></li><li><a href="#spec-stagedefFormat1-section-animationFrame">Animation Frame</a></li></ul><h2>Flags</h2><ul><li><img src="NullOk.png" title="Ok to be left as null"/> Ok to be left as null</li><li><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/> Ok to be left as null if the number of objects is 0/referenced item is not set</li><li><img src="Int32.png" title="4 byte integer"/> 4 byte integer</li><li><img src="Float32.png" title="4 byte float"/> 4 byte float</li><li><img src="Short16.png" title="2 byte short"/> 2 byte short</li><li><img src="Offset32.png" title="4 byte file offset"/> 4 byte file offset</li><li><img src="Unknown.png" title="Unknown"/> Unknown</li></ul><h2 id="spec-stagedefFormat1-section-fileHeader">File Header <a href="#spec-stagedefFormat1-section-fileHeader"><img src="Link.png"/></a></h2><h4>Length: 0xA0/160</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x8</code></td><td>8</td><td/><td>0x00000000, 0x00000064</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Number of collision headers</td><td><a href="#spec-stagedefFormat1-section-collisionHeader"><img src="Link.png"/></a></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Offset to the collision header list</td><td><a href="#spec-stagedefFormat1-section-collisionHeader"><img src="Link.png"/></a></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Size of header (always 0xA0), offset to starting position data</td><td><a href="#spec-stagedefFormat1-section-startPosition"><img src="Link.png"/></a></td></tr><tr><td><code>0x14</code></td><td>20</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Offset to fallout plane Y coordinate, this value minus 0xA0 divided by 0x14 gives the number of start positions</td><td></td></tr><tr><td><code>0x18</code></td><td>24</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Number of goals</td><td><a href="#spec-stagedefFormat1-section-goal"><img src="Link.png"/></a></td></tr><tr><td><code>0x1C</code></td><td>28</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Offset to the goal list</td><td><a href="#spec-stagedefFormat1-section-goal"><img src="Link.png"/></a></td></tr><tr><td><code>0x20</code></td><td>32</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="Unknown.png" title="Unknown"/></td><td>Number of goals, duplicate. Unknown purpose</td><td><a href="#spec-stagedefFormat1-section-goal"><img src="Link.png"/></a></td></tr><tr><td><code>0x24</code></td><td>36</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Null</td><td></td></tr><tr><td><code>0x28</code></td><td>40</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Number of bumpers</td><td><a href="#spec-stagedefFormat1-section-bumper"><img src="Link.png"/></a></td></tr><tr><td><code>0x2C</code></td><td>44</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Offset to the bumper list</td><td><a href="#spec-stagedefFormat1-section-bumper"><img src="Link.png"/></a></td></tr><tr><td><code>0x30</code></td><td>48</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Number of jamabars</td><td><a href="#spec-stagedefFormat1-section-jamabar"><img src="Link.png"/></a></td></tr><tr><td><code>0x34</code></td><td>52</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Offset to the jamabar list</td><td><a href="#spec-stagedefFormat1-section-jamabar"><img src="Link.png"/></a></td></tr><tr><td><code>0x38</code></td><td>56</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Number of bananas</td><td><a href="#spec-stagedefFormat1-section-banana"><img src="Link.png"/></a></td></tr><tr><td><code>0x3C</code></td><td>60</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Offset to the banana list</td><td><a href="#spec-stagedefFormat1-section-banana"><img src="Link.png"/></a></td></tr><tr><td><code>0x40</code></td><td>64</td><td><code>0x10</code></td><td>16</td><td><img src="Unknown.png" title="Unknown"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Null</td><td></td></tr><tr><td><code>0x50</code></td><td>80</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Number of something?</td><td></td></tr><tr><td><code>0x54</code></td><td>84</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Unknown/Offset to list of something?</td><td></td></tr><tr><td><code>0x58</code></td><td>88</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Number of level models</td><td><a href="#spec-stagedefFormat1-section-levelModel"><img src="Link.png"/></a></td></tr><tr><td><code>0x5C</code></td><td>92</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Offset to the level model list</td><td><a href="#spec-stagedefFormat1-section-levelModel"><img src="Link.png"/></a></td></tr><tr><td><code>0x60</code></td><td>96</td><td><code>0x8</code></td><td>8</td><td><img src="Unknown.png" title="Unknown"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Null</td><td></td></tr><tr><td><code>0x68</code></td><td>104</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Number of background models</td><td><a href="#spec-stagedefFormat1-section-backgroundModel"><img src="Link.png"/></a></td></tr><tr><td><code>0x6C</code></td><td>108</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Offset to the background model list</td><td><a href="#spec-stagedefFormat1-section-backgroundModel"><img src="Link.png"/></a></td></tr><tr><td><code>0x70</code></td><td>112</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Number of something?</td><td></td></tr><tr><td><code>0x74</code></td><td>116</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Offset to list of something?</td><td></td></tr><tr><td><code>0x78</code></td><td>120</td><td><code>0x8</code></td><td>8</td><td><img src="Unknown.png" title="Unknown"/></td><td>Levels have 0x00000000 0x00000001 here</td><td></td></tr><tr><td><code>0x80</code></td><td>128</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Number of reflective objects</td><td><a href="#spec-stagedefFormat1-section-reflective"><img src="Link.png"/></a></td></tr><tr><td><code>0x84</code></td><td>132</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/><img src="NullOkIf.png" title="Ok to be left as null if the number of objects is 0/referenced item is not set"/></td><td>Offset to list of reflective objects</td><td><a href="#spec-stagedefFormat1-section-reflective"><img src="Link.png"/></a></td></tr><tr><td><code>0x88</code></td><td>136</td><td><code>0x18</code></td><td>24</td><td><img src="Unknown.png" title="Unknown"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Null</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-startPosition">Start Position <a href="#spec-stagedefFormat1-section-startPosition"><img src="Link.png"/></a></h2><h4>Length: 0x14/20</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X position</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y position</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z position</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>X rotation</td><td></td></tr><tr><td><code>0xE</code></td><td>14</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Y rotation</td><td></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Z rotation</td><td></td></tr><tr><td><code>0x12</code></td><td>18</td><td><code>0x2</code></td><td>2</td><td><img src="NullOk.png" title="Ok to be left as null"/></td><td>Null</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-goal">Goal <a href="#spec-stagedefFormat1-section-goal"><img src="Link.png"/></a></h2><h4>Length: 0x14/20</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X position</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y position</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z position</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>X rotation</td><td></td></tr><tr><td><code>0xE</code></td><td>14</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Y rotation</td><td></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Z rotation</td><td></td></tr><tr><td><code>0x12</code></td><td>18</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Type of goal (0x4200 is blue, 0x4700 is green, 0x5200 is red)</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-bumper">Bumper <a href="#spec-stagedefFormat1-section-bumper"><img src="Link.png"/></a></h2><h4>Length: 0x20/32</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X position</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y position</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z position</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>X rotation</td><td></td></tr><tr><td><code>0xE</code></td><td>14</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Y rotation</td><td></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Z rotation</td><td></td></tr><tr><td><code>0x12</code></td><td>18</td><td><code>0x2</code></td><td>2</td><td><img src="NullOk.png" title="Ok to be left as null"/></td><td>Null</td><td></td></tr><tr><td><code>0x14</code></td><td>20</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X scale</td><td></td></tr><tr><td><code>0x18</code></td><td>24</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y scale</td><td></td></tr><tr><td><code>0x1C</code></td><td>28</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z scale</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-jamabar">Jamabar <a href="#spec-stagedefFormat1-section-jamabar"><img src="Link.png"/></a></h2><h4>Length: 0x20/32</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X position</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y position</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z position</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>X rotation</td><td></td></tr><tr><td><code>0xE</code></td><td>14</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Y rotation</td><td></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Z rotation</td><td></td></tr><tr><td><code>0x12</code></td><td>18</td><td><code>0x2</code></td><td>2</td><td><img src="NullOk.png" title="Ok to be left as null"/></td><td>Null</td><td></td></tr><tr><td><code>0x14</code></td><td>20</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X scale</td><td></td></tr><tr><td><code>0x18</code></td><td>24</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y scale</td><td></td></tr><tr><td><code>0x1C</code></td><td>28</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z scale</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-banana">Banana <a href="#spec-stagedefFormat1-section-banana"><img src="Link.png"/></a></h2><h4>Length: 0x10/16</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X position</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y position</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z position</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Type of banana (Single: 0x00000000, Bunch: 0x00000001)</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-collisionHeader">Collision Header <a href="#spec-stagedefFormat1-section-collisionHeader"><img src="Link.png"/></a></h2><h4>Length: 0xCA/202</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Center of rotation X position (may not work as you expect - check the notes)</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Center of rotation Y position (may not work as you expect - check the notes)</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Center of rotation Z position (may not work as you expect - check the notes)</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Initial X rotation</td><td></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Initial Y rotation</td><td></td></tr><tr><td><code>0x14</code></td><td>20</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Initial Z rotation</td><td></td></tr><tr><td><code>0x18</code></td><td>24</td><td><code>0x2</code></td><td>2</td><td><img src="Unknown.png" title="Unknown"/><img src="Short16.png" title="2 byte short"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Null/Possibly animation loop type</td><td></td></tr><tr><td><code>0x1A</code></td><td>26</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Offset to animation header</td><td><a href="#spec-stagedefFormat1-section-animationHeader"><img src="Link.png"/></a></td></tr><tr><td><code>0x1E</code></td><td>30</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to model reference (points to pointer to name string</td><td></td></tr><tr><td><code>0x22</code></td><td>34</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to triangle list</td><td><a href="#spec-stagedefFormat1-section-collisionTriangle"><img src="Link.png"/></a></td></tr><tr><td><code>0x26</code></td><td>38</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to collision grid list pointers</td><td><a href="#spec-stagedefFormat1-section-collisionGridTriangleListPointer"><img src="Link.png"/></a></td></tr><tr><td><code>0x2A</code></td><td>42</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Start X for collision grid</td><td></td></tr><tr><td><code>0x2E</code></td><td>46</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Start Z for collision grid</td><td></td></tr><tr><td><code>0x32</code></td><td>50</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Step X for collision grid</td><td></td></tr><tr><td><code>0x36</code></td><td>54</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Step Y for collision grid</td><td></td></tr><tr><td><code>0x3A</code></td><td>58</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="Int32.png" title="4 byte integer"/></td><td>0x00000010</td><td></td></tr><tr><td><code>0x3E</code></td><td>62</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="Int32.png" title="4 byte integer"/></td><td>0x00000010</td><td></td></tr><tr><td><code>0x42</code></td><td>66</td><td><code>0x88</code></td><td>136</td><td/><td>Copy of file header, starts from offset 0x18 in the original header, includes only the objects/entities that move with the collision, which obviously excludes background models (put 0 for number/offset for those excluded)</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-levelModel">Level Model <a href="#spec-stagedefFormat1-section-levelModel"><img src="Link.png"/></a></h2><h4>Length: 0xC/12</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>0x00000001</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to the model name to use</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="NullOk.png" title="Ok to be left as null"/></td><td>Null</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-backgroundModel">Background Model <a href="#spec-stagedefFormat1-section-backgroundModel"><img src="Link.png"/></a></h2><h4>Length: 0x38/56</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="Int32.png" title="4 byte integer"/></td><td>0x0000001F</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to model name to use</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="NullOk.png" title="Ok to be left as null"/></td><td>Null</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X position</td><td></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y position</td><td></td></tr><tr><td><code>0x14</code></td><td>20</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z position</td><td></td></tr><tr><td><code>0x18</code></td><td>24</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>X rotation</td><td></td></tr><tr><td><code>0x1A</code></td><td>26</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Y rotation</td><td></td></tr><tr><td><code>0x1C</code></td><td>28</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Z rotation</td><td></td></tr><tr><td><code>0x1E</code></td><td>30</td><td><code>0x2</code></td><td>2</td><td><img src="NullOk.png" title="Ok to be left as null"/></td><td>Null</td><td></td></tr><tr><td><code>0x20</code></td><td>32</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X scale</td><td></td></tr><tr><td><code>0x24</code></td><td>36</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y scale</td><td></td></tr><tr><td><code>0x28</code></td><td>40</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z scale</td><td></td></tr><tr><td><code>0x2C</code></td><td>44</td><td><code>0xC</code></td><td>12</td><td><img src="Unknown.png" title="Unknown"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Null</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-reflective">Reflective Model <a href="#spec-stagedefFormat1-section-reflective"><img src="Link.png"/></a></h2><h4>Length: 0x8/8</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to model name to use</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="NullOk.png" title="Ok to be left as null"/></td><td>Null</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-collisionTriangle">Collision Triangle <a href="#spec-stagedefFormat1-section-collisionTriangle"><img src="Link.png"/></a></h2><h4>Length: 0x40/64</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X1 position</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y1 position</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z1 position</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X normal</td><td></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y normal</td><td></td></tr><tr><td><code>0x14</code></td><td>20</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Z normal</td><td></td></tr><tr><td><code>0x18</code></td><td>24</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>X rotation from XY plane</td><td></td></tr><tr><td><code>0x1A</code></td><td>26</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Y rotation from XY plane</td><td></td></tr><tr><td><code>0x1C</code></td><td>28</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Z rotation from XY plane</td><td></td></tr><tr><td><code>0x1E</code></td><td>30</td><td><code>0x2</code></td><td>2</td><td><img src="NullOk.png" title="Ok to be left as null"/></td><td>Null</td><td></td></tr><tr><td><code>0x20</code></td><td>32</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>DX2X1</td><td></td></tr><tr><td><code>0x24</code></td><td>36</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>DY2Y1</td><td></td></tr><tr><td><code>0x28</code></td><td>40</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>DX3X1</td><td></td></tr><tr><td><code>0x2C</code></td><td>44</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>DY3Y1</td><td></td></tr><tr><td><code>0x30</code></td><td>48</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X tangent</td><td></td></tr><tr><td><code>0x34</code></td><td>52</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y tangent</td><td></td></tr><tr><td><code>0x38</code></td><td>56</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>X bitangent</td><td></td></tr><tr><td><code>0x3C</code></td><td>60</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Y bitangent</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-collisionGridTriangleList">Collision Grid Triangle List <a href="#spec-stagedefFormat1-section-collisionGridTriangleList"><img src="Link.png"/></a></h2><h4>Length: 0x4/4</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>Triangle index</td><td></td></tr><tr><td><code>0x2</code></td><td>2</td><td><code>0x0</code></td><td>0</td><td><img src="Short16.png" title="2 byte short"/></td><td>... (Triangle index is repeated)</td><td></td></tr><tr><td><code>0x2</code></td><td>2</td><td><code>0x2</code></td><td>2</td><td><img src="Short16.png" title="2 byte short"/></td><td>0xFFFF to terminate the list</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-collisionGridTriangleListPointer">Collision Grid Triangle List Pointer <a href="#spec-stagedefFormat1-section-collisionGridTriangleListPointer"><img src="Link.png"/></a></h2><h4>Length: 0x4/4</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Pointer to a triangle list</td><td><a href="#spec-stagedefFormat1-section-collisionGridTriangleList"><img src="Link.png"/></a></td></tr></table><h2 id="spec-stagedefFormat1-section-animationHeader">Animation Header <a href="#spec-stagedefFormat1-section-animationHeader"><img src="Link.png"/></a></h2><h4>Length: 0x48/72</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Number of frames for X rotation</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to X rotation frames</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Number of frames for Y rotation</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to Y rotation frames</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Number of frames for Z rotation</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x14</code></td><td>20</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to Z rotation frames</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x18</code></td><td>24</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Number of frames for X translation</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x1C</code></td><td>28</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to X translation frames</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x20</code></td><td>32</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Number of frames for Y translation</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x24</code></td><td>36</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to Y translation frames</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x28</code></td><td>40</td><td><code>0x4</code></td><td>4</td><td><img src="Int32.png" title="4 byte integer"/></td><td>Number of frames for Z translation</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x2C</code></td><td>44</td><td><code>0x4</code></td><td>4</td><td><img src="Offset32.png" title="4 byte file offset"/></td><td>Offset to Z translation frames</td><td><a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></td></tr><tr><td><code>0x30</code></td><td>48</td><td><code>0x18</code></td><td>24</td><td><img src="Unknown.png" title="Unknown"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown/Null</td><td></td></tr></table><h2 id="spec-stagedefFormat1-section-animationFrame">Animation Frame <a href="#spec-stagedefFormat1-section-animationFrame"><img src="Link.png"/></a></h2><h4>Length: 0x14/20</h4><table class="table"><tr><th>Relative Offset (Hex)</th><th>Relative Offset (Dec)</th><th>Length (Hex)</th><th>Length (Dec)</th><th>Flags</th><th>Info</th><th>Link</th></tr><tr><td><code>0x0</code></td><td>0</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="Int32.png" title="4 byte integer"/></td><td>0x00000002</td><td></td></tr><tr><td><code>0x4</code></td><td>4</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Time, in percent alloted time? (starts at 0 and goes to 100)</td><td></td></tr><tr><td><code>0x8</code></td><td>8</td><td><code>0x4</code></td><td>4</td><td><img src="Float32.png" title="4 byte float"/></td><td>Rotation in degrees or translation in units</td><td></td></tr><tr><td><code>0xC</code></td><td>12</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown, Null works</td><td></td></tr><tr><td><code>0x10</code></td><td>16</td><td><code>0x4</code></td><td>4</td><td><img src="Unknown.png" title="Unknown"/><img src="NullOk.png" title="Ok to be left as null"/></td><td>Unknown, Null works</td><td></td></tr></table>
